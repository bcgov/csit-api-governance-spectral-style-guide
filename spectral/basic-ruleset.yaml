---
# Fully dereferenced Spectral ruleset (all $ref resolved)
# Original: basic-ruleset.yaml
# Generated: 2026-02-11T19:49:17.929Z
extends: spectral:oas
functions:
  - no-empty-property-names
  - oas3_0-schema-requires-example
  - oas3_1-schema-has-example-but-no-examples
  - oas3_1-schema-requires-example
  - oas3-schema-matches-schema
  - path-segments-kebab-case
  - path-segments-no-verbs-blacklist
  - path-segments-no-verbs-probable
rules:
  duplicated-entry-in-enum: error
  no-$ref-siblings: error
  operation-operationId-unique: error
  operation-operationId-valid-in-url: error
  operation-parameters: error
  path-declarations-must-exist: error
  path-not-include-query: error
  path-params: error
  typed-enum: error
  oas2-anyOf: error
  oas2-oneOf: error
  oas2-schema: error
  oas3-examples-value-or-externalValue: error
  oas3-operation-security-defined: error
  oas3-schema: error
  info-description: warn
  no-eval-in-markdown: warn
  no-script-tags-in-markdown: warn
  openapi-tags-alphabetical: warn
  openapi-tags-uniqueness: warn
  operation-description: warn
  operation-operationId: warn
  operation-success-response: warn
  path-keys-no-trailing-slash: warn
  array-items: warn
  oas2-api-host: warn
  oas2-api-schemes: warn
  oas2-discriminator: warn
  oas2-host-not-example: warn
  oas2-host-trailing-slash: warn
  oas2-operation-formData-consume-check: warn
  oas2-operation-security-defined: warn
  oas2-unused-definition: warn
  oas2-valid-media-example: warn
  oas2-valid-schema-example: warn
  oas3-callbacks-in-callbacks: warn
  oas3-server-not-example.com: warn
  oas3-server-trailing-slash: warn
  oas3-server-variables: warn
  oas3-unused-component: warn
  oas3-valid-media-example: warn
  oas3-valid-schema-example: warn
  oas3_1-callbacks-in-webhook: warn
  oas3_1-servers-in-webhook: warn
  oas3-parameter-description: warn
  operation-id-camel-case:
    description: operationId should be camelCase (starts with lowercase letter, no separators)
    message: operationId should be camelCase (starts with lowercase letter, no separators)
    severity: warn
    given: $..operationId
    then:
      function: pattern
      functionOptions:
        match: ^[a-z][a-zA-Z0-9]*$
  path-segments-kebab-case:
    description: Static path segments should be kebab-case (lowercase letters, numbers, hyphens only)
    severity: warn
    given: $.paths.*
    then:
      function: path-segments-kebab-case
  path-param-camel-case:
    description: Path parameter names should be camelCase
    message: Path parameter names should be camelCase (start with lowercase letter, no special characters except letters and numbers)
    severity: warn
    given: $.paths..parameters[?(@.in == 'path')].name
    then:
      function: pattern
      functionOptions:
        match: ^[a-z][a-zA-Z0-9]*$
  query-param-camel-case:
    description: Query parameter names should be camelCase
    message: Query parameter names should be camelCase (start with lowercase letter, no special characters except letters and numbers)
    severity: warn
    given: $.paths..parameters[?(@.in == 'query')].name
    then:
      function: pattern
      functionOptions:
        match: ^[a-z][a-zA-Z0-9]*$
  schema-property-camel-case:
    description: Schema property names should be camelCase
    message: Schema property names should be camelCase (start with lowercase letter, no special characters except letters and numbers)
    severity: warn
    resolved: false
    given:
      - $.definitions..properties
      - $.components.schemas..properties
      - $..properties
    then:
      field: '@key'
      function: pattern
      functionOptions:
        match: ^[a-z][a-zA-Z0-9]*$
  no-empty-property-names:
    description: Property names must not be empty strings. Empty keys are invalid in JSON and poorly supported by tools.
    message: '{{error}}'
    severity: warn
    resolved: false
    given:
      - $..properties
    then:
      function: no-empty-property-names
  operation-summary:
    description: Every operation must have a non-empty summary
    message: Operation is missing a summary or it is empty.
    severity: warn
    given: $..[get,put,post,delete,patch,options,head,trace]
    then:
      field: summary
      function: truthy
  oas3_0-schema-requires-example:
    description: |
      Requires 'example' in OAS 3.0.x documents on:
      - every top-level Schema Object (reusable or inline in paths/responses/parameters/headers/request bodies)
      Does NOT require examples on subschemas inside properties or items.
    message: '{{error}}'
    severity: warn
    formats:
      - oas3_0
    resolved: false
    given:
      - $.components.schemas.*
      - $.paths[*][*].responses[*].content.*.schema
      - $.paths[*][*].parameters[*].schema
      - $.components.parameters.*.schema
      - $.paths[*][*].responses[*].headers.*.schema
      - $.components.responses[*].headers.*.schema
      - $.components.headers.*.schema
      - $.paths[*][*].requestBody.content.*.schema
      - $.components.requestBodies.*.content.*.schema
      - $.paths[*][*].requestBody.content.*.encoding.*.headers.*.schema
      - $.components.responses.*.content.*.schema
    then:
      function: oas3_0-schema-requires-example
  oas3_1-schema-requires-example:
    description: |
      Requires 'example' or 'examples' in OAS 3.1.x documents on:
      - every top-level Schema Object (reusable or inline in paths/responses/parameters/headers/request bodies)
      Does NOT require examples on subschemas inside properties or items.
    message: '{{error}}'
    severity: warn
    formats:
      - oas3_1
    resolved: false
    given:
      - $.components.schemas.*
      - $.paths[*][*].responses[*].content.*.schema
      - $.paths[*][*].parameters[*].schema
      - $.components.parameters.*.schema
      - $.paths[*][*].responses[*].headers.*.schema
      - $.components.responses[*].headers.*.schema
      - $.components.headers.*.schema
      - $.paths[*][*].requestBody.content.*.schema
      - $.components.requestBodies.*.content.*.schema
      - $.paths[*][*].requestBody.content.*.encoding.*.headers.*.schema
      - $.components.responses.*.content.*.schema
    then:
      function: oas3_1-schema-requires-example
  oas3_1-prefer-examples-over-example:
    description: |
      In OAS 3.1, prefer 'examples' over the deprecated 'example'.
      Warn only when 'example' is used **without** 'examples' (i.e. prefer 'examples' when providing examples).
      No warning if both are present, only 'examples' is present, or neither is present.
    message: Use 'examples' instead of (or in addition to) the deprecated 'example' in OAS 3.1 schemas
    severity: warn
    formats:
      - oas3_1
    given:
      - $.components.schemas.*
      - $.paths[*][*].responses[*].content.*.schema
      - $.paths[*][*].parameters[*].schema
      - $.components.parameters.*.schema
      - $.paths[*][*].responses[*].headers.*.schema
      - $.components.responses[*].headers.*.schema
      - $.components.headers.*.schema
      - $.paths[*][*].requestBody.content.*.schema
      - $.components.requestBodies.*.content.*.schema
      - $.paths[*][*].requestBody.content.*.encoding.*.headers.*.schema
      - $.components.responses.*.content.*.schema
    then:
      function: oas3_1-schema-has-example-but-no-examples
  oas2-require-openapi-3:
    description: Document must use OpenAPI 3.x (or newer). Swagger 2.0 is not allowed.
    message: 'Swagger 2.0 detected (uses ''swagger'' key). Use ''openapi: 3.x.x'' instead.'
    severity: warn
    given: $
    then:
      function: falsy
      field: swagger
  path-segments-no-verbs-blacklist:
    description: Path segments must not contain blacklisted verbs (e.g., create, update, validate)
    message: '{{error}}'
    severity: warn
    given: $.paths
    then:
      field: '@key'
      function: path-segments-no-verbs-blacklist
  contact-properties: 'off'
  info-contact: 'off'
  info-license: 'off'
  license-url: 'off'
  openapi-tags: 'off'
  operation-singular-tag: 'off'
  operation-tag-defined: 'off'
  operation-tags: 'off'
  tag-description: 'off'
  oas2-parameter-description: 'off'
  oas3-api-servers: 'off'
  path-segments-no-verbs-probable:
    description: Path segments should preferably be nouns (NLP heuristic, excludes blacklisted verbs)
    message: '{{error}}'
    severity: 'off'
    given: $.paths
    then:
      field: '@key'
      function: path-segments-no-verbs-probable
      functionOptions:
        skipBlacklisted: true
        allowed:
          - file
        disallowed:
          - import
          - export
  oas3_0-problem-details-response-structure:
    description: 400 and 422 responses must match the ProblemDetails schema structure (RFC 9457 style) in OpenAPI 3.0 documents
    message: '{{error}}'
    severity: warn
    formats:
      - oas3_0
    given:
      - $..responses.400.content['application/json'].schema
      - $..responses.422.content['application/json'].schema
    then:
      function: oas3-schema-matches-schema
      functionOptions:
        schemaName: ProblemDetailResponse
        allowAdditionalProperties: true
        debug: false
        expectedSchema:
          title: ProblemDetailResponse
          description: Canonical model for problem details as defined by RFC-9457
          type: object
          required:
            - type
            - title
            - status
            - errors
          properties:
            type:
              type: string
              title: Type
              description: A URI reference that identifies the problem type
              example: tag:validation-errors
            title:
              type: string
              title: Title
              description: A short, human-readable summary of the problem type
              example: Bad Request
            status:
              type: integer
              title: Status
              description: A number indicating the HTTP status code generated for this occurrence of the problem
              example: 400
            detail:
              title: Detail
              description: A human-readable explanation specific to this occurrence of the problem
              type: string
              nullable: true
              example: One or more validation errors occurred
            errors:
              type: array
              minItems: 1
              title: Errors
              description: A list of individual error occurrences found, with details and a pointer to the location of each
              items:
                title: ProblemDetailErrorItem
                description: Represents a single detailed error within a Problem Details response (RFC 9457). Provides granular information about what went wrong in the request, typically used in validation, semantic, or business-rule failures.
                type: object
                required:
                  - location
                  - code
                  - message
                  - type
                properties:
                  location:
                    title: ProblemDetailErrorLocation
                    description: The location on the HTTP request for which a problem has been detected. (e.g., body, query, header, path, cookie).
                    type: string
                    enum:
                      - body
                      - query
                      - header
                      - path
                      - cookie
                    example: body
                  code:
                    type: string
                    title: Code
                    description: A machine-readable error code that identifies the specific type of error. Should be stable and documented for programmatic handling. Follows the 'application/problem+json' error code pattern from RFC 9457.
                    example: INVALID_LINE_NUMBER
                  message:
                    type: string
                    title: Message
                    description: A short, human-readable summary of the error suitable for display to end-users or in logs. Should be clear and concise (RFC 9457 recommends avoiding technical jargon where possible).
                    example: Line number does not exist in the specified document
                  type:
                    type: string
                    title: Type
                    description: A URI reference or tag that identifies the problem type (RFC 9457 'type' field). Often used to categorize errors (e.g., validation, authorization, business-rule). When using tags instead of URIs, prefix with 'tag:' is a common convention.
                    example: tag:validation-error
                  field:
                    title: Field
                    description: The name of the specific field/property in the request that caused the error (when applicable). Useful for form-based or structured input validation.
                    type: string
                    nullable: true
                    example: taxYear
                  detail:
                    title: Detail
                    description: A more detailed human-readable explanation of the error, providing additional context beyond the short message (maps to RFC 9457 'detail' field). May include contextual information or suggested corrections.
                    type: string
                    nullable: true
                    example: Line 99999 is not present in T1 General for 2024
                  received:
                    title: Received
                    description: The actual value received by the server that caused the error (useful for debugging and helping clients understand what was invalid).
                    type: string
                    nullable: true
                    example: '99999'
                  pointer:
                    title: Pointer
                    description: JSON Pointer (RFC 6901) to the exact location of the error within the request body (e.g., '#/lineNumbers/0'). Highly recommended for deep/nested validation errors (aligns with RFC 9457 best practices).
                    type: string
                    nullable: true
                    example: '#/lineNumbers/1'
                  constraints:
                    title: Constraints
                    description: Optional object containing validation constraint violations (e.g., minLength, pattern, enum values). Keys are constraint names, values are expected values or descriptions. Useful for schema-based validation libraries.
                    type: object
                    additionalProperties: true
                    nullable: true
                    example:
                      minLength: 9
                      pattern: ^\d{9}$
                example:
                  code: REQUIRED_FIELD_MISSING
                  detail: One of 'sin' or both 'fullLegalName' and 'birthDate' must be provided
                  field: individual
                  location: body
                  message: Missing required identifier
                  pointer: '#/identifier'
                  received: ''
                  type: tag:validation-error
          example:
            detail: Invalid line numbers provided
            errors:
              - code: INVALID_LINE_NUMBER
                location: body
                message: Line number does not exist in the document
                pointer: '#/lineNumbers/0'
                received: '99999'
                type: tag:validation-error
            instance: /tax-documents/query
            status: 400
            title: Bad Request
            type: tag:validation-errors
  oas3_1-problem-details-response-structure:
    description: 400 and 422 responses must match the ProblemDetails schema structure (RFC 9457 style) in OpenAPI 3.1 documents
    message: '{{error}}'
    severity: warn
    formats:
      - oas3_1
    given:
      - $..responses.400.content['application/json'].schema
      - $..responses.422.content['application/json'].schema
    then:
      function: oas3-schema-matches-schema
      functionOptions:
        schemaName: ProblemDetailResponse
        allowAdditionalProperties: true
        debug: false
        expectedSchema:
          title: ProblemDetailResponse
          description: Canonical model for problem details as defined by RFC-9457
          type: object
          required:
            - type
            - title
            - status
            - errors
          properties:
            type:
              type: string
              title: Type
              description: A URI reference that identifies the problem type
              example: tag:validation-errors
            title:
              type: string
              title: Title
              description: A short, human-readable summary of the problem type
              example: Bad Request
            status:
              type: integer
              title: Status
              description: A number indicating the HTTP status code generated for this occurrence of the problem
              example: 400
            detail:
              title: Detail
              description: A human-readable explanation specific to this occurrence of the problem
              anyOf:
                - type: string
                - type: 'null'
              example: One or more validation errors occurred
            errors:
              type: array
              minItems: 1
              title: Errors
              description: A list of individual error occurrences found, with details and a pointer to the location of each
              items:
                title: ProblemDetailErrorItem
                description: Represents a single detailed error within a Problem Details response (RFC 9457). Provides granular information about what went wrong in the request, typically used in validation, semantic, or business-rule failures.
                type: object
                required:
                  - location
                  - code
                  - message
                  - type
                properties:
                  location:
                    title: ProblemDetailErrorLocation
                    description: The location on the HTTP request for which a problem has been detected. (e.g., body, query, header, path, cookie).
                    type: string
                    enum:
                      - body
                      - query
                      - header
                      - path
                      - cookie
                    examples:
                      - body
                  code:
                    type: string
                    title: Code
                    description: A machine-readable error code that identifies the specific type of error. Should be stable and documented for programmatic handling. Follows the 'application/problem+json' error code pattern from RFC 9457.
                    example: INVALID_LINE_NUMBER
                  message:
                    type: string
                    title: Message
                    description: A short, human-readable summary of the error suitable for display to end-users or in logs. Should be clear and concise (RFC 9457 recommends avoiding technical jargon where possible).
                    example: Line number does not exist in the specified document
                  type:
                    type: string
                    title: Type
                    description: A URI reference or tag that identifies the problem type (RFC 9457 'type' field). Often used to categorize errors (e.g., validation, authorization, business-rule). When using tags instead of URIs, prefix with 'tag:' is a common convention.
                    example: tag:validation-error
                  field:
                    title: Field
                    description: The name of the specific field/property in the request that caused the error (when applicable). Useful for form-based or structured input validation.
                    anyOf:
                      - type: string
                      - type: 'null'
                    example: taxYear
                  detail:
                    title: Detail
                    description: A more detailed human-readable explanation of the error, providing additional context beyond the short message (maps to RFC 9457 'detail' field). May include contextual information or suggested corrections.
                    anyOf:
                      - type: string
                      - type: 'null'
                    example: Line 99999 is not present in T1 General for 2024
                  received:
                    title: Received
                    description: The actual value received by the server that caused the error (useful for debugging and helping clients understand what was invalid).
                    anyOf:
                      - type: string
                      - type: 'null'
                    example: '99999'
                  pointer:
                    title: Pointer
                    description: JSON Pointer (RFC 6901) to the exact location of the error within the request body (e.g., '#/lineNumbers/0'). Highly recommended for deep/nested validation errors (aligns with RFC 9457 best practices).
                    anyOf:
                      - type: string
                      - type: 'null'
                    example: '#/lineNumbers/1'
                  constraints:
                    title: Constraints
                    description: Optional object containing validation constraint violations (e.g., minLength, pattern, enum values). Keys are constraint names, values are expected values or descriptions. Useful for schema-based validation libraries.
                    anyOf:
                      - type: object
                        additionalProperties: true
                      - type: 'null'
                    example:
                      minLength: 9
                      pattern: ^\d{9}$
                examples:
                  - code: REQUIRED_FIELD_MISSING
                    detail: One of 'sin' or both 'fullLegalName' and 'birthDate' must be provided
                    field: individual
                    location: body
                    message: Missing required identifier
                    pointer: '#/identifier'
                    received: ''
                    type: tag:validation-error
          examples:
            - detail: Invalid line numbers provided
              errors:
                - code: INVALID_LINE_NUMBER
                  location: body
                  message: Line number does not exist in the document
                  pointer: '#/lineNumbers/0'
                  received: '99999'
                  type: tag:validation-error
              instance: /tax-documents/query
              status: 400
              title: Bad Request
              type: tag:validation-errors
  oas3_0-internal-error-response-structure:
    description: 500 responses must conform to the canonical error response schema in OpenAPI 3.0 documents
    message: '{{error}}'
    severity: warn
    formats:
      - oas3_0
    given: $..responses.500.content['application/json'].schema
    then:
      function: oas3-schema-matches-schema
      functionOptions:
        schemaName: ErrorResponse
        allowAdditionalProperties: true
        debug: false
        expectedSchema:
          title: ErrorResponse
          description: Standard error response format for unexpected or server-side errors (e.g., 500 Internal Server Error, 403 Forbidden, 401 Unauthorized, etc.). This is used when a more structured Problem Details response (RFC 9457) is not appropriate or when the error is general rather than validation-specific.
          type: object
          required:
            - error
            - message
          properties:
            error:
              type: string
              title: Error
              description: A short, machine-readable error code or identifier that categorizes the type of error. This field is stable and intended for programmatic handling by clients (e.g., mapping to specific error-handling logic). Common values include 'internal_error', 'forbidden', 'unauthorized', 'rate_limit_exceeded', etc.
              example: forbidden
            message:
              type: string
              title: Message
              description: A human-readable summary of the error, suitable for display to end-users or logging. Should be clear, concise, and avoid exposing internal technical details or sensitive information (per security best practices).
              example: You are not authorized to access this resource
            details:
              title: Details
              description: Optional additional context or structured details about the error. This can include extra information useful for debugging (e.g., error codes from downstream systems, correlation IDs, or custom attributes). Use sparingly and avoid including sensitive data.
              type: object
              nullable: true
              additionalProperties: true
              example:
                correlationId: req-abc123-xyz
                timestamp: '2026-01-16T19:22:00Z'
          example:
            error: forbidden
            message: You are not authorized to access this resource
            details:
              correlationId: req-abc123-xyz
  oas3_1-internal-error-response-structure:
    description: 500 responses must conform to the canonical error response schema in OpenAPI 3.1 documents
    message: '{{error}}'
    severity: warn
    formats:
      - oas3_1
    given: $..responses.500.content['application/json'].schema
    then:
      function: oas3-schema-matches-schema
      functionOptions:
        schemaName: ErrorResponse
        allowAdditionalProperties: true
        debug: false
        expectedSchema:
          title: ErrorResponse
          description: Standard error response format for unexpected or server-side errors (e.g., 500 Internal Server Error, 403 Forbidden, 401 Unauthorized, etc.). This is used when a more structured Problem Details response (RFC 9457) is not appropriate or when the error is general rather than validation-specific.
          type: object
          required:
            - error
            - message
          properties:
            error:
              type: string
              title: Error
              description: A short, machine-readable error code or identifier that categorizes the type of error. This field is stable and intended for programmatic handling by clients (e.g., mapping to specific error-handling logic). Common values include 'internal_error', 'forbidden', 'unauthorized', 'rate_limit_exceeded', etc.
              examples:
                - forbidden
            message:
              type: string
              title: Message
              description: A human-readable summary of the error, suitable for display to end-users or logging. Should be clear, concise, and avoid exposing internal technical details or sensitive information (per security best practices).
              examples:
                - You are not authorized to access this resource
            details:
              title: Details
              description: Optional additional context or structured details about the error. This can include extra information useful for debugging (e.g., error codes from downstream systems, correlation IDs, or custom attributes). Use sparingly and avoid including sensitive data.
              anyOf:
                - type: object
                  additionalProperties: true
              examples:
                - correlationId: req-abc123-xyz
                  timestamp: '2026-01-16T19:22:00Z'
          examples:
            - error: forbidden
              message: You are not authorized to access this resource
              details:
                correlationId: req-abc123-xyz
